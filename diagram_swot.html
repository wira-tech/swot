<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Diagram SWOT Dinamis</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  display: flex;
  gap: 20px;
  padding: 20px;
}

.panel {
  width: 260px;
  background: white;
  padding: 15px;
  border-radius: 12px;
  box-shadow: 0 6px 15px rgba(0,0,0,.1);
}

.value-box {
  margin-top: 10px;
  background: #eef2ff;
  padding: 8px;
  border-radius: 8px;
  font-size: 13px;
}

label {
  font-size: 13px;
  margin-top: 8px;
  display: block;
}

input {
  width: 100%;
  padding: 6px;
}

button {
  width: 100%;
  margin-top: 12px;
  padding: 8px;
  background: #2563eb;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

canvas {
  background: white;
  border-radius: 12px;
  box-shadow: 0 6px 15px rgba(0,0,0,.1);
}
</style>
</head>
<body>

<div class="panel">


  <h3 align="center">Input Skor SWOT</h3>

  <label>Strength</label>
  <input type="number" id="S" value="3">

  <label>Weakness</label>
  <input type="number" id="W" value="-2">

  <label>Opportunities</label>
  <input type="number" id="O" value="2">

  <label>Threat</label>
  <input type="number" id="T" value="-1">

  <div class="value-box">
    <b>Nilai X = (S - W) / 2 =</b> <span id="A"> 1</span><br>
    <b>Nilai Y = (O - T) / 2 =</b> <span id="B"> 1</span>
  </div>

  <button onclick="draw()">Generate</button>
  <button onclick="saveImage('jpg')">Download JPG</button>
</div>

<canvas id="c" width="650" height="500"></canvas>

<script>
const S = parseFloat(localStorage.getItem("totalStrength")) || 0;
const W = parseFloat(localStorage.getItem("totalWeakness")) || 0;
const O = parseFloat(localStorage.getItem("totalOpportunity")) || 0;
const T = parseFloat(localStorage.getItem("totalThreat")) || 0;

const X = (S - W) / 2;
const Y = (O - T) / 2;

// isi otomatis ke input (kalau ada)
document.getElementById("inputStrength").value = S;
document.getElementById("inputWeakness").value = W;
document.getElementById("inputOpportunity").value = O;
document.getElementById("inputThreat").value = T;

// panggil fungsi gambar diagram
drawSWOT(X, Y);

function saveImage(type) {
  const canvas = document.getElementById("c");
  const link = document.createElement("a");

{
    link.download = "diagram_swot.jpg";
    link.href = canvas.toDataURL("image/jpeg", 1.0);
  }

  link.click();
}

function draw() {
  const S = +document.getElementById("S").value;
  const W = +document.getElementById("W").value;
  const O = +document.getElementById("O").value;
  const T = +document.getElementById("T").value;

  const A = (S - W) / 2;
  const B = (O - T) / 2;

  document.getElementById("A").textContent = A.toFixed(2);
  document.getElementById("B").textContent = B.toFixed(2);

  const canvas = document.getElementById("c");
  const ctx = canvas.getContext("2d");
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "#ffffff";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  const cx = canvas.width / 2;
  const cy = canvas.height / 2;
  const scaleX = 60;
  const scaleY = 60;

// ===== JUDUL DIAGRAM =====
ctx.fillStyle = "#000";
ctx.font = "bold 18px Arial";
ctx.textAlign = "center";
ctx.fillText("DIAGRAM ANALISIS SWOT", canvas.width / 1.3, 30);
ctx.font = "12px Arial";
ctx.fillText("(berdasarkan perhitungan IFAS dan EFAS)", canvas.width / 1.3, 48);

// ===== AXIS (HITAM) =====
ctx.strokeStyle = "#000";
ctx.lineWidth = 1;
ctx.beginPath();
ctx.moveTo(0, cy);
ctx.lineTo(canvas.width, cy);
ctx.moveTo(cx, 0);
ctx.lineTo(cx, canvas.height);
ctx.stroke();

  // Axis numbers
  ctx.font = "12px Arial";
  for (let i = -4; i <= 4; i++) {
    ctx.fillText(i, cx + i * scaleX - 4, cy + 25);
  }
  for (let i = -3; i <= 3; i++) {
    if (i !== 0)
      ctx.fillText(i, cx - 18, cy - i * scaleY + 4);
  }

// ===== OUTER BOX (HITAM) =====
ctx.strokeRect(
  cx - 4 * scaleX,
  cy - 3 * scaleY,
  8 * scaleX,
  6 * scaleY
);

  // Dynamic inner box
  ctx.strokeStyle = "#2563eb";
  ctx.lineWidth = 2;
  ctx.strokeRect(
    cx + Math.min(0, W) * scaleX,
    cy - Math.max(0, O) * scaleY,
    (S - W) * scaleX,
    (O - T) * scaleY
  );

  // Point
  const px = cx + A * scaleX;
  const py = cy - B * scaleY;

  ctx.fillStyle = "#2563eb";
  ctx.beginPath();
  ctx.arc(px, py, 6, 0, Math.PI * 2);
  ctx.fill();

  // Dashed guide

ctx.setLineDash([5,5]);

// Dari titik (A,B) ke sumbu X (vertikal)
ctx.beginPath();
ctx.moveTo(px, py);
ctx.lineTo(px, cy);
ctx.stroke();

// Dari titik (A,B) ke sumbu Y (horizontal)
ctx.beginPath();
ctx.moveTo(px, py);
ctx.lineTo(cx, py);
ctx.stroke();

// Dari titik pusat (0,0) ke titik strategi
ctx.beginPath();
ctx.moveTo(cx, cy);
ctx.lineTo(px, py);
ctx.stroke();

ctx.setLineDash([]);

// ===== TICKS X (MAJOR + MINOR) =====
ctx.strokeStyle = "#000";

for (let i = -4; i <= 4; i++) {

  // Major tick
  const xMajor = cx + i * scaleX;
  ctx.beginPath();
  ctx.moveTo(xMajor, cy - 8);
  ctx.lineTo(xMajor, cy + 8);
  ctx.stroke();

  // Minor ticks kiri & kanan
  if (i < 4) {
    for (let j = 1; j <= 4; j++) {
      const xMinor = cx + (i + j / 5) * scaleX;
      ctx.beginPath();
      ctx.moveTo(xMinor, cy - 4);
      ctx.lineTo(xMinor, cy + 4);
      ctx.stroke();
    }
  }
}

// ===== TICKS Y (MAJOR + MINOR) =====
for (let i = -3; i <= 3; i++) {

  // Major tick
  const yMajor = cy - i * scaleY;
  ctx.beginPath();
  ctx.moveTo(cx - 8, yMajor);
  ctx.lineTo(cx + 8, yMajor);
  ctx.stroke();

  // Minor ticks atas & bawah
  if (i < 3) {
    for (let j = 1; j <= 4; j++) {
      const yMinor = cy - (i + j / 5) * scaleY;
      ctx.beginPath();
      ctx.moveTo(cx - 4, yMinor);
      ctx.lineTo(cx + 4, yMinor);
      ctx.stroke();
    }
  }
}


  // Label point
  ctx.fillStyle = "#000";
  ctx.fillText(`(${A.toFixed(2)}, ${B.toFixed(2)})`, px + 8, py - 8);

  // Axis labels
  ctx.fillText("Strength", canvas.width - 50, cy - 5);
  ctx.fillText("Weakness", 50, cy - 5);
  ctx.fillText("Opportunities", cx - 45, 60);
  ctx.fillText("Threat", cx - 30, canvas.height - 50);

  // Quadrants
  ctx.font = "16px Arial";
  ctx.fillText("I", cx + 2.8 * scaleX, cy - 2.2 * scaleY);
  ctx.fillText("II", cx - 3.4 * scaleX, cy - 2.2 * scaleY);
  ctx.fillText("III", cx + 2.8 * scaleX, cy + 2.4 * scaleY);
  ctx.fillText("IV", cx - 3.4 * scaleX, cy + 2.4 * scaleY);
}
draw();


</script>

</body>

</html>
